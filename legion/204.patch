From fad9ef2156d2c7e734e9b291b8c61bd7c7cc79f4 Mon Sep 17 00:00:00 2001
From: Christoph Junghans <junghans@lanl.gov>
Date: Tue, 1 Nov 2016 14:44:03 -0600
Subject: [PATCH] fix build on arm (fixes #202)

---
 examples/circuit/circuit_cpu.cc   | 2 ++
 runtime/legion/legion_utilities.h | 2 ++
 runtime/lowlevel_dma.cc           | 2 ++
 3 files changed, 6 insertions(+)

diff --git a/examples/circuit/circuit_cpu.cc b/examples/circuit/circuit_cpu.cc
index 78eaf4c..339c55c 100644
--- a/examples/circuit/circuit_cpu.cc
+++ b/examples/circuit/circuit_cpu.cc
@@ -15,7 +15,9 @@
 
 
 #include "circuit.h"
+#if defined(__i386__) || defined(__x86_64__)
 #include <x86intrin.h>
+#endif
 #include <cmath>
 
 using namespace LegionRuntime::Accessor;
diff --git a/runtime/legion/legion_utilities.h b/runtime/legion/legion_utilities.h
index f7703cf..0db3552 100644
--- a/runtime/legion/legion_utilities.h
+++ b/runtime/legion/legion_utilities.h
@@ -28,7 +28,9 @@
 
 // Apple can go screw itself
 #ifndef __MACH__
+#if defined(__i386__) || defined(__x86_64__)
 #include <x86intrin.h>
+#endif
 #else
 #ifdef __SSE2__
 #include <emmintrin.h>
diff --git a/runtime/lowlevel_dma.cc b/runtime/lowlevel_dma.cc
index 72eb6e4..6463c6c 100644
--- a/runtime/lowlevel_dma.cc
+++ b/runtime/lowlevel_dma.cc
@@ -40,7 +40,9 @@
 
 using namespace LegionRuntime::Accessor;
 
+#ifndef __GNUC__
 #include "atomics.h"
+#endif
 
 #include "realm/timers.h"
 #include "realm/serialize.h"
