From ef26bec6ac1531fd61ed4e6e7509046e45cd8614 Mon Sep 17 00:00:00 2001
From: Christoph Junghans <junghans@lanl.gov>
Date: Sat, 17 Sep 2016 11:47:54 -0600
Subject: [PATCH] make check: filter get_pc_thunk from fPIC code

---
 other/Makefile-libgasnet.mak.in | 2 +-
 other/ammpi/Makefile.am         | 1 +
 other/amudp/Makefile.am         | 1 +
 3 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/other/Makefile-libgasnet.mak.in b/other/Makefile-libgasnet.mak.in
index 0f8e8f6..d8a3a3c 100644
--- a/other/Makefile-libgasnet.mak.in
+++ b/other/Makefile-libgasnet.mak.in
@@ -208,7 +208,7 @@ $(top_builddir)/other/Makefile-libgasnet.mak: $(top_srcdir)/other/Makefile-libga
 @GNU_NM_TRUE@		    -e ' [\._]*fh_' -e ' [\._]*firehose_'                           \
 @GNU_NM_TRUE@		    -e ' [\._]*fh[ic]_' -e ' [\._]*fhsmp_' -e ' [\._]*fhuni_'       \
 @GNU_NM_TRUE@		    -e ' [\._]*myxml_' -e ' [\._]*smp_coll_'                        \
-@GNU_NM_TRUE@		    -e ' [\._]*emutls_'                                             \
+@GNU_NM_TRUE@		    -e ' [\._]*emutls_' -e 'get_pc_thunk'                           \
 @GNU_NM_TRUE@		    -e ' D bg_[a-z]' -e ' D _uci_' -e ' D _parse[A-Z][a-z]'         \
 @GNU_NM_TRUE@		    -e __FUNCTION__ -e __PRETTY_FUNCTION__ -e ' [\._]*DWinfo'       \
 @GNU_NM_TRUE@               -e ' [\._][\._]*debug_'                                              \
diff --git a/other/ammpi/Makefile.am b/other/ammpi/Makefile.am
index ab8b691..7da5978 100644
--- a/other/ammpi/Makefile.am
+++ b/other/ammpi/Makefile.am
@@ -105,6 +105,7 @@ check-exports: libammpi.a
             @NM@ --defined-only $$lib |                                             \
             grep -v -e ' [\._]*ammpi_' -e ' [\._]*AMMPI_' -e ' [\._]*AM_'           \
                     -e ' [\._]*gasnett_' -e ' [\._]*gasneti_'                       \
+                    -e 'get_pc_thunk'                                               \
                     -e __FUNCTION__ -e __PRETTY_FUNCTION__ -e debug_info_seg |      \
             @PERL@ -n -e 'print if /^[0-9a-fA-F]+\s+[A-Z]\s+/' > .$$lib.exp;        \
           if test -s .$$lib.exp ; then                                              \
diff --git a/other/amudp/Makefile.am b/other/amudp/Makefile.am
index 8d8a646..1e63e10 100644
--- a/other/amudp/Makefile.am
+++ b/other/amudp/Makefile.am
@@ -142,6 +142,7 @@ check-exports: libamudp.a
             @NM@ --defined-only $$lib |                                             \
             grep -v -e ' [\._]*amudp_' -e ' [\._]*AMUDP_' -e ' [\._]*AM_'           \
                     -e ' [\._]*gasnett_' -e ' [\._]*gasneti_'                       \
+                    -e 'get_pc_thunk'                                               \
                     -e __FUNCTION__ -e __PRETTY_FUNCTION__ -e debug_info_seg |      \
             @PERL@ -n -e 'print if /^[0-9a-fA-F]+\s+[A-Z]\s+/' > .$$lib.exp;        \
           if test -s .$$lib.exp ; then                                              \
-- 
2.7.4.1.g5468f9e

